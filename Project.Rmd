---
title: "Project"
author: "Dipankar Lahiri"
date: "2025-04-25"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(forcats)
library(stringr)
library(ggplot2)
library(rstatix)
library(ggdist)
library(gt)

my_df <- read_csv("/Users/dipankarlahiri/Desktop/Project/AI Responses Combined.csv")
colnames(my_df)[4] <- "AI Use"
colnames(my_df)[5] <- "AI Purpose"
colnames(my_df)[6] <- "Replace Human"
colnames(my_df)[7] <- "Productive"
colnames(my_df)[9] <- "Grade"
colnames(my_df)[10] <- "Income"
colnames(my_df)[13] <- "Social media use"
colnames(my_df)[14] <- "Subject"
my_df$Gender <- ifelse(str_to_lower(my_df$Gender) == "female", "Female", "Not Female")
ai_use_order <- c("Never", "Less than 5 minutes", "Between 5 minutes and 30 minutes", 
                  "30 minutes to 2 hours", "More than 2 hours")
my_df$`AI Use` <- factor(my_df$`AI Use`, levels = ai_use_order, ordered = TRUE)
my_df$`AI Purpose` <- ifelse(
  str_detect(my_df$`AI Purpose`, "Learning \\(e\\.g\\., studying, academic help\\)|Work \\(e\\.g\\., professional tasks, projects\\)"),
  "Learning/Work", "Others"
)
my_df$`Replace Human` <- ifelse(str_to_lower(my_df$`Replace Human`) == "no", "No", "Yes")
my_df$Productive <- ifelse(str_to_lower(my_df$Productive) == "yes", "Yes", "No")
my_df$Grade <- ifelse(my_df$Grade %in% c("Excellent (Top grades in most subjects)", "Good (Above-average performance)"),
                      "Good", "Bad")
my_df$Income <- ifelse(my_df$Income %in% c("High (Significantly above the national average)",
                                           "Upper-Middle (Above the national average)"),
                       "High", "Low")
my_df <- my_df %>%
  mutate(`Social Skills` = `Social confidence` - `Social awkwardness`) %>%
  select(-`Social confidence`, -`Social awkwardness`)
social_media_order <- c("Less than 1 hour", "Between 1 and 2 hours", 
                        "Between 3 and 4 hours", "Between 4 and 5 hours", "More than 5 hours")
my_df$`Social media use` <- factor(my_df$`Social media use`, levels = social_media_order, ordered = TRUE)
my_df$Subject <- ifelse(my_df$Subject %in% c("Social Sciences", "Humanities"), "Arts", "Science")
my_df <- my_df %>% select(-13)
my_df$`AI Use` <- recode(my_df$`AI Use`,
  "Never" = 0,
  "Less than 5 minutes" = 1,
  "Between 5 minutes and 30 minutes" = 2,
  "30 minutes to 2 hours" = 3,
  "More than 2 hours" = 4
)
my_df$`Social media use` <- recode(my_df$`Social media use`,
  "Less than 1 hour" = 1,
  "Between 1 and 2 hours" = 2,
  "Between 3 and 4 hours" = 3,
  "Between 4 and 5 hours" = 4,
  "More than 5 hours" = 5
)

my_df <- my_df %>% select(Gender, Subject, `AI Use`, Trust, Age, Nationality, `Replace Human`, Productive)
my_df1 <- subset(my_df, Nationality != "Chinese")

```

# Descriptive Stats, Viz.

## Age

```{r}
summary(my_df$Age)
hist(my_df$Age, main = "Age Distribution", xlab = "Age", col = "skyblue", breaks = 10)
```

## Gender

```{r}
table(my_df$Gender)
barplot(table(my_df$Gender), main = "Gender Distribution", col = "lightgreen", ylab = "Count")


```

## AI Use

```{r}
summary(my_df$`AI Use`)
ai_use_summary <- my_df %>%
  count(`AI Use`) %>%
  mutate(Percentage = n / sum(n) * 100) %>%
  rename(Count = n, `AI Use Level` = `AI Use`)
print(ai_use_summary)
hist(my_df$`AI Use`, main = "AI Use (increasing intensity)", xlab = "AI Use Score", col = "lightblue", breaks = 5)

```


## Used AI to replace human?

```{r}
table(my_df$`Replace Human`)
barplot(table(my_df$`Replace Human`), main = "Ever Replaced Human?", col = "orchid", ylab = "Count")


```

# Productivity with AI

```{r}
table(my_df$Productive)
barplot(table(my_df$Productive), main = "Feels More Productive with AI?", col = "gold", ylab = "Count")

```

## AI Trust

```{r}
summary(my_df$Trust)
trust_summary <- my_df %>%
  count(`Trust`) %>%
  mutate(Percentage = n / sum(n) * 100) %>%
  rename(Count = n, `Trust Level` = `Trust`)
print(trust_summary)
hist(my_df$Trust, main = "Trust in AI", xlab = "Trust Score", col = "skyblue", breaks = 5)

```

## Subject

```{r}
table(my_df$Subject)
barplot(table(my_df$Subject), main = "Field of Study", col = "steelblue", ylab = "Count")


```

# Correlation tests (N=155)

## H1: Males use AI chatbots more than females.

```{r}

my_df %>%
  group_by(Gender) %>%
  summarise(
    n = n(),
    median_AI_Use = median(`AI Use`),
    mean_AI_Use = round(mean(`AI Use`), 2),
    .groups = 'drop'
  )

h1_table <- my_df %>%
  group_by(Gender) %>%
  summarise(
    n = n(),
    Median = median(`AI Use`),
    Mean = round(mean(`AI Use`), 2),
    SD = round(sd(`AI Use`), 2),
    Min = min(`AI Use`),
    Max = max(`AI Use`),
    .groups = 'drop'
  ) %>%
  gt() %>%
  tab_header(
    title = md("**AI Chatbot Usage by Gender**"),
    subtitle = "0-4 scale (Higher = more frequent use)"
  ) %>%
  fmt_number(
    columns = c(Mean, SD),
    decimals = 2
  ) %>%
  cols_label(
    n = md("**N**"),
    Median = md("**Median**"),
    Mean = md("**Mean**"),
    SD = md("**SD**")
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels()
  )
h1_table

my_df %>%
  count(Gender, `AI Use`) %>%
  ggplot(aes(Gender, `AI Use`, fill = n)) +
  geom_tile(color = "white") +
  geom_text(aes(label = n), color = "white") +
  scale_fill_gradient(low = "#FF6B6B", high = "#4ECDC4") +
  scale_y_continuous(breaks = 0:4) +
  labs(title = "AI Use Frequency by Gender",
       x = NULL, y = "AI Use (0-4)") +
  theme_minimal()

ggplot(my_df, aes(Gender, `AI Use`, fill = Gender)) +
  geom_boxplot() +
  scale_fill_manual(values = c("Not Female" = "#4ECDC4", "Female" = "#FF6B6B")) +
  labs(title = "Males Use AI More Frequently",
       subtitle = "Median: Males = 3, Females = 2",
       y = "AI Use Frequency (0-4 scale)") +
  theme_minimal()

my_df$Gender <- factor(my_df$Gender, levels = c("Not Female", "Female"))
wilcox.test(`AI Use` ~ Gender, data = my_df)
wilcox_effsize(`AI Use` ~ Gender, data = my_df, ci = TRUE)
effsize <- wilcox_effsize(`AI Use` ~ Gender, data = my_df, ci = TRUE)
cat(sprintf(
  "\nProbability superiority: P(Male > Female) = %.1f%% (95%% CI [%.1f%%, %.1f%%])",
  (effsize$effsize + 1)/2 * 100,  # Convert to percentage
  (effsize$conf.low + 1)/2 * 100,
  (effsize$conf.high + 1)/2 * 100
))
```

A Wilcoxon rank-sum test (equivalent to Mann-Whitney U test) revealed a statistically significant difference in AI use frequency between genders (W = 2685.5, *p* = .002), with males (Mdn = 3.0, *n* = 33) reporting higher usage than females (Mdn = 2.0, *n* = 122). The effect size was small-to-medium (rank-biserial *r* = 0.25, 95% CI [0.07, 0.43]), indicating a 62.7% probability that a randomly selected male would report higher AI use than a randomly selected female (95% CI [54.0%, 70.5%]).

Note. The Wilcoxon rank-sum test (Mann-Whitney U test) was used because: The outcome (AI Use) was ordinal, Groups were independent, and Distributions were non-normal. Effect sizes were interpreted as: *r* = 0.10 (small), 0.30 (medium), 0.50 (large).

## H2: Males show higher levels of trust for information generated by AI chatbots than females.

```{r}

my_df %>%
  group_by(Gender) %>%
  summarise(
    n = n(),
    median = median(Trust),
    .groups = 'drop'
  )

h2_table <- my_df %>%
  group_by(Gender) %>%
  summarise(
    n = n(),
    Median = median(Trust),
    Mean = round(mean(Trust), 2),
    SD = round(sd(Trust), 2),
    Min = min(Trust),
    Max = max(Trust),
    .groups = 'drop'
  ) %>%
  gt() %>%
  tab_header(
    title = md("**AI Trust Levels by Gender**"),
    subtitle = "1-5 scale (Higher = more trust)"
  ) %>%
  fmt_number(
    columns = c(Mean, SD),
    decimals = 2
  ) %>%
  cols_label(
    n = md("**N**"),
    Median = md("**Median**"),
    Mean = md("**Mean**"),
    SD = md("**SD**")
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels()
  ) %>%
  tab_footnote(
    footnote = "Note: Trust measured on 1 (Low) to 5 (High) scale",
    locations = cells_title(groups = "subtitle")
  )

h2_table

ggplot(my_df, aes(Gender, fill = factor(Trust))) +
  geom_bar(position = "fill") +
  scale_fill_brewer(palette = "RdYlGn", direction = -1) +  # Red(low)-Green(high)
  scale_y_continuous(labels = scales::percent) +
  labs(title = "AI Trust Levels by Gender",
       y = "Percentage",
       fill = "Trust Score") +
  theme_minimal() +
  theme(legend.position = "bottom")

ggplot(my_df, aes(Gender, Trust, color = Gender)) +
  geom_jitter(width = 0.15, height = 0.15, alpha = 0.4, size = 2) +
  geom_point(data = trust_summary, aes(y = median), 
             shape = 21, size = 8, fill = "white", stroke = 1.5) +
  geom_text(data = trust_summary, aes(y = median, label = median), 
            color = "black", size = 3.5) +
  scale_color_manual(values = c("Not Female" = "#4ECDC4", "Female" = "#FF6B6B")) +
  scale_y_continuous(breaks = 1:5, limits = c(1, 5.5)) +
  labs(title = "Males Show Higher Median AI Trust",
       subtitle = "White circles show medians (Males=4, Females=3)",
       y = "Trust Level (1-5)") +
  theme_minimal()

wilcox.test(Trust ~ Gender, data = my_df)
wilcox_effsize(Trust ~ Gender, data = my_df, ci = TRUE)
effsize <- wilcox_effsize(Trust ~ Gender, data = my_df, ci = TRUE)
prob_superiority <- (effsize$effsize + 1)/2
prob_ci_low <- (effsize$conf.low + 1)/2  
prob_ci_high <- (effsize$conf.high + 1)/2
cat(sprintf(
  "Probability superiority: P(Male > Female) = %.1f%% (95%% CI [%.1f%%, %.1f%%])",
  prob_superiority * 100,
  prob_ci_low * 100,
  prob_ci_high * 100
))

```

A Wilcoxon rank-sum test (equivalent to Mann-Whitney U test) revealed a statistically significant difference in trust levels between genders (W = 2542, *p* = .011), with males (Mdn = 4.0, *n* = 33) reporting higher trust than females (Mdn = 3.0, *n* = 122). The effect size was small-to-medium (rank-biserial *r* = 0.21, 95% CI [0.04, 0.37]), indicating a 60.3% probability that a randomly selected male would trust AI-generated information more than a randomly selected female (95% CI [52.5%, 68.5%]).

The Wilcoxon rank-sum test (Mann-Whitney U test) was used because: The outcome (Trust) was ordinal (5-point scale), Groups were independent, and Distributions were non-normal. The test statistic W is R’s implementation of the Mann-Whitney U test.

## H3: Those who study STEM subjects show higher levels of trust for information generated by AI chatbots than those who study Humanities and Social Sciences.

```{r}

my_df %>%
  group_by(Subject) %>%
  summarise(
    n = n(),
    Median = median(Trust),
    Mean = round(mean(Trust), 2),
    SD = round(sd(Trust), 2),
    .groups = 'drop'
  )

h3_table <- my_df %>%
  group_by(Subject) %>%  # Using your actual column name
  summarise(
    n = n(),
    Median = median(Trust),
    Mean = round(mean(Trust), 2),
    SD = round(sd(Trust), 2),
    Min = min(Trust),
    Max = max(Trust),
    .groups = 'drop'
  ) %>%
  gt() %>%
  tab_header(
    title = md("**AI Trust by Field of Study**"),
    subtitle = "Science vs. Arts students"
  ) %>%
  fmt_number(
    columns = c(Mean, SD),
    decimals = 2
  ) %>%
  cols_label(
    n = md("**N**"),
    Median = md("**Median**"),
    Mean = md("**Mean**"),
    SD = md("**SD**")
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels()
  ) %>%
  data_color(
    columns = Median,
    colors = scales::col_numeric(
      palette = c("#FF6B6B", "#4ECDC4"),
      domain = c(1, 5)  # Trust scale range
    )
  )
h3_table

ggplot(my_df, aes(Subject, fill = factor(Trust))) +
  geom_bar(position = "fill") +
  scale_fill_brewer(palette = "RdYlGn", direction = -1) +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = "AI Trust Levels by Field of Study",
    y = "Percentage",
    fill = "Trust Score"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom")


ggplot(my_df, aes(Subject, Trust, fill = Subject)) +
  geom_boxplot(width = 0.5, alpha = 0.8) +
  geom_jitter(width = 0.1, alpha = 0.4, size = 2) +
  scale_fill_manual(values = c("Science" = "#4ECDC4", "Arts" = "#FF6B6B")) +
  labs(
    title = "Science Students Show Higher AI Trust",
    x = NULL, 
    y = "Trust Level (1-5)",
    caption = "Boxes show medians; points represent individual responses"
  ) +
  theme_minimal()

ggplot(my_df, aes(Subject, Trust, fill = Subject)) + 
  geom_violin(alpha = 0.7) +
  geom_boxplot(width = 0.2, fill = "white") +
  scale_fill_manual(values = c("Science" = "#4ECDC4", "Arts" = "#FF6B6B")) +
  labs(title = "Science Students Show Higher Trust Distribution",
       subtitle = "Despite equal medians (3.0), Science students skew toward higher trust",
       y = "Trust Level (1-5)") +
  theme_minimal()

wilcox.test(Trust ~ Subject, data = my_df, exact = FALSE)
wilcox_effsize(Trust ~ Subject, data = my_df, ci = TRUE)
effsize <- wilcox_effsize(Trust ~ Subject, data = my_df, ci = TRUE)
prob_superiority <- (effsize$effsize + 1)/2
prob_ci_low <- (effsize$conf.low + 1)/2  
prob_ci_high <- (effsize$conf.high + 1)/2
cat(sprintf(
  "Probability superiority: P(Science > Arts) = %.1f%% (95%% CI [%.1f%%, %.1f%%])",
  prob_superiority * 100,
  prob_ci_low * 100,
  prob_ci_high * 100
))
```

A Wilcoxon rank-sum test (equivalent to Mann-Whitney U test) revealed a statistically significant difference in trust levels between fields of study (W = 2357.5, *p* = .014), with Science students (Mdn = 3.0, *n* = 85) reporting higher trust than Arts students (Mdn = 3.0, *n* = 70). The effect size was small (rank-biserial *r* = 0.20, 95% CI [0.06, 0.36]), indicating a 59.8% probability that a randomly selected Science student would trust AI-generated information more than an Arts student (95% CI [52.0%, 67.0%]). While medians are equal (3.0), the test detects distributional differences in ranks (Science students skew higher).
